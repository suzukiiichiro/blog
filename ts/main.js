(()=>{var l=class{galleryUID;items=[];constructor(e,i=1){if(window.PhotoSwipe==null||window.PhotoSwipeUI_Default==null){console.error("PhotoSwipe lib not loaded.");return}this.galleryUID=i,l.createGallery(e),this.loadItems(e),this.bindClick()}loadItems(e){this.items=[];let i=e.querySelectorAll("figure.gallery-image");for(let t of i){let o=t.querySelector("figcaption"),r=t.querySelector("img"),s={w:parseInt(r.getAttribute("width")),h:parseInt(r.getAttribute("height")),src:r.src,msrc:r.getAttribute("data-thumb")||r.src,el:t};o&&(s.title=o.innerHTML),this.items.push(s)}}static createGallery(e){let i=e.querySelectorAll("figure.gallery-image"),t=[];for(let o of i)t.length?o.previousElementSibling===t[t.length-1]?t.push(o):t.length&&(l.wrap(t),t=[o]):t=[o];t.length>0&&l.wrap(t)}static wrap(e){let i=document.createElement("div");i.className="gallery";let t=e[0].parentNode,o=e[0];t.insertBefore(i,o);for(let r of e)i.appendChild(r)}open(e){let i=document.querySelector(".pswp");new window.PhotoSwipe(i,window.PhotoSwipeUI_Default,this.items,{index:e,galleryUID:this.galleryUID,getThumbBoundsFn:o=>{let r=this.items[o].el.getElementsByTagName("img")[0],s=window.pageYOffset||document.documentElement.scrollTop,c=r.getBoundingClientRect();return{x:c.left,y:c.top+s,w:c.width}}}).init()}bindClick(){for(let[e,i]of this.items.entries())i.el.querySelector("a").addEventListener("click",o=>{o.preventDefault(),this.open(e)})}},g=l;var a={};if(localStorage.hasOwnProperty("StackColorsCache"))try{a=JSON.parse(localStorage.getItem("StackColorsCache"))}catch{a={}}async function f(n,e,i){if(!n)return await Vibrant.from(i).getPalette();if(!a.hasOwnProperty(n)||a[n].hash!==e){let t=await Vibrant.from(i).getPalette();a[n]={hash:e,Vibrant:{hex:t.Vibrant.hex,rgb:t.Vibrant.rgb,bodyTextColor:t.Vibrant.bodyTextColor},DarkMuted:{hex:t.DarkMuted.hex,rgb:t.DarkMuted.rgb,bodyTextColor:t.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(a))}return a[n]}function b(){let n=document.getElementById("toggle-menu");n&&n.addEventListener("click",()=>{document.getElementById("main-menu").classList.contains("transiting")||document.body.classList.toggle("show-menu")})}function k(n,e,i){var t=document.createElement(n);for(let o in e)if(o&&e.hasOwnProperty(o)){let r=e[o];o=="dangerouslySetInnerHTML"?t.innerHTML=r.__html:r===!0?t.setAttribute(o,o):r!==!1&&r!=null&&t.setAttribute(o,r.toString())}for(let o=2;o<arguments.length;o++){let r=arguments[o];r&&t.appendChild(r.nodeType==null?document.createTextNode(r.toString()):r)}return t}var S=k;var p=class{localStorageKey="StackColorScheme";currentScheme;systemPreferScheme;constructor(e){this.bindMatchMedia(),this.currentScheme=this.getSavedScheme(),this.dispatchEvent(document.documentElement.dataset.scheme),e&&this.bindClick(e),document.body.style.transition==""&&document.body.style.setProperty("transition","background-color .3s ease")}saveScheme(){localStorage.setItem(this.localStorageKey,this.currentScheme)}bindClick(e){e.addEventListener("click",i=>{this.isDark()?this.currentScheme="light":this.currentScheme="dark",this.setBodyClass(),this.currentScheme==this.systemPreferScheme&&(this.currentScheme="auto"),this.saveScheme()})}isDark(){return this.currentScheme=="dark"||this.currentScheme=="auto"&&this.systemPreferScheme=="dark"}dispatchEvent(e){let i=new CustomEvent("onColorSchemeChange",{detail:e});window.dispatchEvent(i)}setBodyClass(){this.isDark()?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light",this.dispatchEvent(document.documentElement.dataset.scheme)}getSavedScheme(){let e=localStorage.getItem(this.localStorageKey);return e=="light"||e=="dark"||e=="auto"?e:"auto"}bindMatchMedia(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?this.systemPreferScheme="dark":this.systemPreferScheme="light",this.setBodyClass()})}},w=p;var v={init:()=>{b();let n=document.querySelector(".article-content");n&&new g(n);let e=document.querySelector(".article-list--tile");e&&new IntersectionObserver(async(s,c)=>{s.forEach(d=>{if(!d.isIntersecting)return;c.unobserve(d.target),d.target.querySelectorAll("article.has-image").forEach(async y=>{let u=y.querySelector("img"),E=u.src,T=u.getAttribute("data-key"),P=u.getAttribute("data-hash"),C=y.querySelector(".article-details"),m=await f(T,P,E);C.style.background=`
                        linear-gradient(0deg, 
                            rgba(${m.DarkMuted.rgb[0]}, ${m.DarkMuted.rgb[1]}, ${m.DarkMuted.rgb[2]}, 0.5) 0%, 
                            rgba(${m.Vibrant.rgb[0]}, ${m.Vibrant.rgb[1]}, ${m.Vibrant.rgb[2]}, 0.75) 100%)`})})}).observe(e);let i=document.querySelectorAll(".article-content .highlight"),t="Copy",o="Copied!";i.forEach(r=>{let s=document.createElement("button");s.innerHTML=t,s.classList.add("copyCodeButton"),r.appendChild(s);let d=r.getElementsByTagName("pre")[0].textContent;s.addEventListener("click",()=>{navigator.clipboard.writeText(d).then(()=>{s.textContent=o,setTimeout(()=>{s.textContent=t},1e3)}).catch(h=>{alert(h),console.log("Something went wrong",h)})})}),new w(document.getElementById("dark-mode-toggle"))}};window.addEventListener("load",()=>{setTimeout(function(){v.init()},0)});window.Stack=v;window.createElement=S;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
